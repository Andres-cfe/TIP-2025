<style>
    .fake {
        background-image: url(img/p2/bg4.jpg);
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
    }

    .wcard {
        perspective: 1000px!important;
        display: inline-block;
    }
    .txt-global {
        position: absolute;
        max-width: 75%;
        left: 0;
        right: 0;
        margin: 0 auto;
        top: 50%;
        transform: translateY(-50%);
    }
    .disabled {
        opacity: 1!important;
    }
</style>
<div class="page-sco full w-100">
    <div class="container">
        <div class="row justify-content-center align-items-center">
            <div class="col-12">
                <div class="row justify-content-center">
                    <div class="col-12 mb-3 animate__animated animate__lightSpeedInLeft">
                        <h2 class="fw-bold text-rojo-1 text-center">Retos de la movilidad sostenible</h2>
                        <p class="text-center">La movilidad sostenible tiene grandes beneficios, pero también enfrenta desafíos importantes.</p>
                    </div>
                    <div class="col-12 ins0 animate__animated animate__zoomIn text-center mb-3" style="display: none;">
                        <div class="text-rojo-1 bg-white border border-2 border-dark rounded w-auto d-inline-block px-2">
                            <div class="d-flex flex-row py-2">
                                <i class="fa-light fa-arrow-pointer mx-2"></i>
                                <span>Da clic en cada tarjeta</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="row justify-content-center align-items-end align-items-xl-start">
                            <div class="col-9 col-md-5 col-lg-4 mb-4 mb-lg-0 apa0 animate__animated animate__zoomIn" style="display: none;">
                                <div class="card bg-transparent border-0 rounded-0 shadow-none p-0 h-100">
                                    <div class="row justify-content-center h-100">
                                        <div class="col-12">
                                            <div class="row justify-content-center">
                                                <div class="col-12 mb-3">
                                                    <p class="mb-0 text-verde text-center fw-bold">Desarrollo de Infraestructura de Carga</p>
                                                </div>
                                                <div class="col-12 text-center">
                                                    <div class="wcard disabled">
                                                        <div class="front">
                                                            <img src="img/p2/04.png" class="img-fluid">
                                                            <div class="txt-global text-center">
                                                                Aunque la red de carga está creciendo, aún es insuficiente en muchas regiones, especialmente fuera de grandes ciudades.
                                                            </div>
                                                        </div>
                                                        <div class="back">
                                                            <img src="img/p2/05.png" class="img-fluid">
                                                            <div class="txt-global text-center text-white">
                                                                <p class="mb-0"><strong>Desafío:</strong><br> Ampliar la cobertura de estaciones de carga públicas y fomentar instalaciones domésticas y empresariales.</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-9 col-md-5 col-lg-4 mb-4 mb-lg-0 apa1 animate__animated animate__zoomIn" style="display: none;">
                                <div class="card bg-transparent border-0 rounded-0 shadow-none p-0 h-100">
                                    <div class="row justify-content-center h-100">
                                        <div class="col-12">
                                            <div class="row justify-content-center">
                                                <div class="col-12 mb-3">
                                                    <p class="mb-0 text-verde text-center fw-bold">Costo Inicial de Adquisición</p>
                                                </div>
                                                <div class="col-12 text-center">
                                                    <div class="wcard disabled">
                                                        <div class="front">
                                                            <img src="img/p2/04.png" class="img-fluid">
                                                            <div class="txt-global text-center">
                                                                A pesar de los incentivos, los vehículos eléctricos aún tienen un precio de entrada más alto que los de combustión interna.
                                                            </div>
                                                        </div>
                                                        <div class="back">
                                                            <img src="img/p2/05.png" class="img-fluid">
                                                            <div class="txt-global text-center text-white">
                                                                <p class="mb-0"><strong>Desafío:</strong><br> Reducir costos mediante producción local, incentivos adicionales y financiamiento accesible.</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-9 col-md-5 col-lg-4 apa2 animate__animated animate__zoomIn" style="display: none;">
                                <div class="card bg-transparent border-0 rounded-0 shadow-none p-0 h-100">
                                    <div class="row justify-content-center h-100">
                                        <div class="col-12">
                                            <div class="row justify-content-center">
                                                <div class="col-12 mb-3">
                                                    <p class="mb-0 text-verde text-center fw-bold">Autonomía y Desempeño de las Baterías</p>
                                                </div>
                                                <div class="col-12 text-center">
                                                    <div class="wcard carta3 disabled">
                                                        <div class="front">
                                                            <img src="img/p2/04.png" class="img-fluid">
                                                            <div class="txt-global text-center">
                                                                Aunque las autonomías han mejorado, sigue existiendo la "ansiedad por la carga" en ciertos usuarios.
                                                            </div>
                                                        </div>
                                                        <div class="back">
                                                            <img src="img/p2/05.png" class="img-fluid">
                                                            <div class="txt-global text-center text-white">
                                                                <p class="mb-0"><strong>Desafío:</strong><br> Mejorar la tecnología de baterías para mayor autonomía, menor tiempo de carga y reciclaje eficiente.</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(function () {
        "use strict";

        $('body').addClass('fake');
        
        $('#template-instruction').removeClass('show');

        const audio_m60 = course360.createSound('audio/audio_m60.mp3');
        const audio_m64 = course360.createSound('audio/audio_m64.mp3');

        course360.audioController.stopAllSoundsAndPlay(audio_m60);

        // Definir rutas de audio para cada carta
        const cardAudios = [
            { front: "audio/audio_m61.mp3", back: "audio/audio_m65.mp3" },
            { front: "audio/audio_m62.mp3", back: "audio/audio_m66.mp3" },
            { front: "audio/audio_m63.mp3", back: "audio/audio_m67.mp3" }
        ];

        // Crear los sonidos y guardarlos
        const audios = cardAudios.map(function (pair) {
            return {
                front: course360.createSound(pair.front),
                back: course360.createSound(pair.back)
            };
        });

        audio_m60.on('end',function(){
            course360.audioController.stopAllSoundsAndPlay(audios[0].front);
            $('.apa0').show();
        });

        audios[0].front.on('end',function(){
            course360.audioController.stopAllSoundsAndPlay(audios[1].front);
            $('.apa1').show();
        });

        audios[1].front.on('end',function(){
            course360.audioController.stopAllSoundsAndPlay(audios[2].front);
            $('.apa2').show();
        });

        audios[2].front.on('end',function(){
            if(!$('.carta3').hasClass('visited')){
                course360.audioController.stopAllSoundsAndPlay(audio_m64);
            }
        });

        audio_m64.on('end',function(){
            $('.ins0').show();
            $(".wcard").removeClass('disabled').addClass('animate__animated animate__pulse animate__infinite');
        });

        // Inicializar flip en todas las cartas
        $(".wcard").each(function (index) {
            const $card = $(this);

            $card.flip({
                trigger: 'manual',
                front: '.front',
                back: '.back'
            });

            $card.on("click", function () {
                const flip = $card.data("flip-model");
                const isFlipped = flip.isFlipped;

                $(this).removeClass('animate__animated animate__pulse animate__infinite').addClass('visited');

                // Voltear la carta
                $card.flip('toggle');

                // Elegir el audio correcto (según si estaba volteada o no antes del clic)
                const selectedAudio = isFlipped ? audios[index].front : audios[index].back;

                // Reproducir el audio
                course360.audioController.stopAllSoundsAndPlay(selectedAudio);

                // Marcar esta carta como volteada al menos una vez
                $card.data('flipped', true);

                // Si todas las cartas han sido volteadas al menos una vez, marcar slide como visitado
                if ($('.wcard').length === $('.wcard').filter(function () {
                    return $(this).data('flipped');
                }).length) {
                    course360.setSlideVisited();
                }
            });
        });
    });
</script>